// Prisma Schema for Podcast Random Player

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Podcast 節目表
model Podcast {
  id              String         @id @default(cuid())
  externalId      String         @unique
  title           String
  author          String?
  description     String?
  coverImage      String?
  feedUrl         String         @unique
  website         String?
  language        String?
  applePodcastId  String?        // Apple Podcast ID for deep linking
  lastFetchedAt   DateTime       @default(now())
  createdAt       DateTime       @default(now())
  updatedAt       DateTime       @updatedAt
  episodes        Episode[]
  
  @@index([externalId])
  @@map("podcasts")
}

// Podcast 單集表
model Episode {
  id              String     @id @default(cuid())
  externalId      String     @unique
  podcastId       String
  title           String
  description     String?
  audioUrl        String
  duration        Int        // 秒數
  pubDate         DateTime
  coverImage      String?
  appleEpisodeId  String?    // Apple Podcast episode ID
  createdAt       DateTime   @default(now())
  updatedAt       DateTime   @updatedAt
  podcast         Podcast    @relation(fields: [podcastId], references: [id], onDelete: Cascade)
  
  @@index([podcastId])
  @@index([pubDate])
  @@map("episodes")
}
